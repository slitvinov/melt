echo both
dimension          3
units              si
atom_style         meso

variable           n    equal 20
variable           Ly  equal 1e-3
variable           F equal 1e-4
variable           mass equal 1
variable           rho equal 1e3
variable           eta  equal 1e-6
variable           mu  equal ${eta}/${rho}
variable           dx   equal ${Ly}/${n}
variable           Lx  equal 6*${dx}
variable           Lz  equal 6*${dx}
variable           cutoff equal 3*${dx}
variable           c      equal 1.25e-3
lattice            sc ${dx}
variable           mass equal ${rho}*${dx}^3

region             box block 0.0 ${Lx}  0.0 ${Ly} 0.0 ${Lz} units box
create_box         1 box
create_atoms       1 region box
mass               1 ${mass}

set                group all meso/rho ${rho}
pair_style         sph/taitwater/morris
pair_coeff         * *  ${rho} ${c} ${mu} ${cutoff}

compute            rho_peratom all meso/rho/atom
fix                integrate_fix_full all meso

dump               dump_id all custom 10 *.dat id type x y z vx vy vz
dump_modify        dump_id first yes
dump_modify        dump_id sort id
dump_modify        dump_id pad 8
thermo             100

neighbor           3.0e-6 bin
neigh_modify       delay 0 check yes
timestep           5.0e-5

variable           f atom mass*$F*((y>${Ly}/2.0)-(y<${Ly}/2.0))
fix                reverce_periodic all addforce v_f 0 0

run                4000
